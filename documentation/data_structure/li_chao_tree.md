---
title: Li Chao Tree
documentation_of: data_structure/li_chao_tree.hpp
---
Li Chao Tree は、区間内の直線群に対する最小値（または最大値）クエリを高速に処理するためのデータ構造です。この実装は、コンストラクタで与えられた離散的な座標集合に対して動作する静的なバージョンです。座標圧縮を内部的に行います。

テンプレートパラメータ:
- `T`: 直線の係数および座標の型。
- `e`: 最小値（または最大値）の単位元を返す関数。`T e()` の形式である必要があります。最小値を求める場合は十分に大きな値を、最大値を求める場合は十分に小さな値を返します。

# 使い方
## コンストラクタ

```cpp
LiChaoTree(const std::vector<T>& vec)
```

### 説明

管理する座標集合 `vec` を元に Li Chao Tree を構築します。`vec` は内部でソートされ、重複が排除されて座標圧縮に利用されます。

- `vec`: 管理する座標の集合。

### 計算量

$O(M \log M)$ (ただし $M$ は `vec` のサイズ)

## add (直線追加)

```cpp
void add(T a, T b, T L, T R)
```

### 説明

元の座標系における区間 `[L, R)` に直線 $y = ax + b$ を追加します。内部的には、コンストラクタで与えられた座標集合のうち、区間 `[L, R)` に含まれる座標に対応する区間に直線を追加します。

- `a`: 直線の傾き。
- `b`: 直線の切片。
- `L`: 直線を追加する区間の左端 (inclusive)。
- `R`: 直線を追加する区間の右端 (exclusive)。

### 制約

`L < R` である必要があります。また、`L` および `R` はコンストラクタで与えられた座標集合の範囲内にあることが想定されますが、実装はそれより広い範囲も受け入れます（ただし、実際に直線が追加されるのは座標集合内の点に対応する区間のみです）。

### 計算量

$O(\log^2 N)$ (ただし $N$ は座標圧縮後の座標数)

## operator() (クエリ)

```cpp
T operator()(T x)
```

### 説明

元の座標系における座標 `x` における、追加された全ての直線の最小値（または最大値）を返します。座標 `x` はコンストラクタで与えられた座標集合に含まれている必要があります。

- `x`: クエリ座標。
- 戻り値: 座標 `x` における最小値（または最大値）。

### 制約

座標 `x` はコンストラクタで与えられた座標集合に含まれている必要があります。

### 計算量

$O(\log N)$ (ただし $N$ は座標圧縮後の座標数)
